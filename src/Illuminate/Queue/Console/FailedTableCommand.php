<?php namespace Illuminate\Queue\Console; use Illuminate\Console\Command; use Illuminate\Filesystem\Filesystem; class FailedTableCommand extends Command { protected $name = 'queue:failed-table'; protected $description = 'Create a migration for the failed queue jobs database table'; protected $files; public function __construct(Filesystem $files) { parent::__construct(); $this->files = $files; } public function fire() { $fullPath = $this->createBaseMigration(); $this->files->put($fullPath, $this->files->get(__DIR__.'/stubs/failed_jobs.stub')); $this->info('Migration created successfully!'); } protected function createBaseMigration() { $name = 'create_failed_jobs_table'; $path = $this->laravel['path'].'/database/migrations'; return $this->laravel['migration.creator']->create($name, $path); } }
