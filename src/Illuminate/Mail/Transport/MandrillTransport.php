<?php namespace Illuminate\Mail\Transport; use Swift_Transport; use Swift_Mime_Message; use Swift_Events_EventListener; class MandrillTransport implements Swift_Transport { protected $key; public function __construct($key) { $this->key = $key; } public function isStarted() { return true; } public function start() { return true; } public function stop() { return true; } public function send(Swift_Mime_Message $message, &$failedRecipients = null) { $client = $this->getHttpClient(); $client->post('https://mandrillapp.com/api/1.0/messages/send-raw.json', [ 'body' => [ 'key' => $this->key, 'raw_message' => (string) $message, 'async' => true, ], ]); } public function registerPlugin(Swift_Events_EventListener $plugin) { } protected function getHttpClient() { return new \GuzzleHttp\Client; } public function getKey() { return $this->key; } public function setKey($key) { return $this->key = $key; } }
