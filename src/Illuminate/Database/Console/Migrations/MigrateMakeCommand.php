<?php namespace Illuminate\Database\Console\Migrations; use Symfony\Component\Console\Input\InputOption; use Symfony\Component\Console\Input\InputArgument; use Illuminate\Database\Migrations\MigrationCreator; class MigrateMakeCommand extends BaseCommand { protected $name = 'migrate:make'; protected $description = 'Create a new migration file'; protected $creator; protected $packagePath; public function __construct(MigrationCreator $creator, $packagePath) { parent::__construct(); $this->creator = $creator; $this->packagePath = $packagePath; } public function fire() { $name = $this->input->getArgument('name'); $table = $this->input->getOption('table'); $create = $this->input->getOption('create'); if ( ! $table && is_string($create)) $table = $create; $this->writeMigration($name, $table, $create); $this->call('dump-autoload'); } protected function writeMigration($name, $table, $create) { $path = $this->getMigrationPath(); $file = pathinfo($this->creator->create($name, $path, $table, $create), PATHINFO_FILENAME); $this->line("<info>Created Migration:</info> $file"); } protected function getArguments() { return array( array('name', InputArgument::REQUIRED, 'The name of the migration'), ); } protected function getOptions() { return array( array('bench', null, InputOption::VALUE_OPTIONAL, 'The workbench the migration belongs to.', null), array('create', null, InputOption::VALUE_OPTIONAL, 'The table to be created.'), array('package', null, InputOption::VALUE_OPTIONAL, 'The package the migration belongs to.', null), array('path', null, InputOption::VALUE_OPTIONAL, 'Where to store the migration.', null), array('table', null, InputOption::VALUE_OPTIONAL, 'The table to migrate.'), ); } }
